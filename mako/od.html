<%inherit file="open_data_base.html"/>
  <%block name='extracss'>
  div.dataTables_scroll { clear: both; }
  .sidescroll { overflow-x: auto;}
  .vertical_scroll { overflow-y: auto;}
  .clickable { cursor:pointer;}

  span.clickable:hover,
  p.clickable:hover {
    text-decoration: underline;
  }
  .section-header {
    padding-bottom : 5px;
    margin-bottom : 10px;
    border-bottom: 1px solid #CCC;
    width: 100%
  }
  .section-footer {
    padding-top : 5px;
    border-top: 1px solid #CCC;
    width: 100%;
  }
  .well-table {
    background-color : transparent;
    border: 0px solid;
  }
  .well-table *{
    background-color : transparent;
    border: 0px solid;
  }
  .well {
    background-color : #f5f5f5;
  }
  th.sorting_asc,
  th.sorting_desc {
    background-color:#D9EDF7;
   }
  div.int{width: 90px;text-align:center;}
  div.big-int{width: 120px;text-align:right;}
  .table-medium th div.str {
    color: white;  /* overide the WET standard for .str */
  }
  div.str{
    width: 150px;
    color: #000; /* overide the WET standard for .str */
  }
  div.wide-str{width: 300px;}
  div.percentage{width: 90px;text-align:center;}
  div.date{width: 90px;}
  
  div.dept_menu {
    z-index: 5000;
    position: absolute;
    top: 0px;
  }
  table thead tr th div.big-int{text-align: center;}
  .table_a a, .table_a a:visited{
    text-decoration : none;
    color: #000;
  }
  tr.odd:not(.background-medium){
   background-color: #f9f9f9;
  }
  ul.hover li:hover {
   background-color: #eeeeee;
  }
  ul.hover li{
   padding : 0px 5px 5px 10px;
  }
  ul.hover a{
   text-decoration : none;
  }
  ul.hover a:hover{
   text-decoration : underline;
  }
  .nav-header {
    display: block;
    padding: 3px 15px;
    font-size: 11px;
    font-weight: bold;
    line-height: 20px;
    color: #999999;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);
    text-transform: uppercase;
  }
  </%block>

  <div id='app'>

  </div>

<%block name='templates'>
<script type='text/plain' id='ver_navbar_t'>
<ul class='nav'>
  <li> <a href='#' class='home'>{{{gt "home"}}}</a> </li>
  <li> <a href='#' class='dept_sel'> {{gt "select"}}</a> </li>
  <li>
    <form class="navbar-search pull-left">
      <input type="text" class='search-query span2 dept_search' />
    </form>
  </li>
</ul>
</script>
<script type='text/plain' id='hori_navbar_t'>
<ul class='nav'>
  <li> <a href='#' class='home'>{{gt "home" }}</a> </li>
</ul>
</script>
<script type='text/plain' id='home_t'>
<div>
  <div class='span-8 background-medium align-middle'>
    <div class='span-1 margin-top-medium margin-bottom-medium' id='back_button'>
    </div>
    <div class='span-3 margin-top-medium margin-bottom-medium'>
      <label for='org_search' style='display:inline-block'>
        {{gt "search"}} 
      </label>
      <input id='org_search' class='dept_search width-50 margin-bottom-none' 
        type='text' style='display:inline-block'
        list='org_suggestions' style='display: inline-block'></input>
    </div>
    <div class='span-2 margin-top-medium margin-bottom-medium'>
      <button class='button button-dark dept_sel'>
          {{{gt "click"}}}
      </button>
      here to select from a list of departments.
    </div>
  </div>
  <div class='org_list_by_min span-8'>


  </div>
  <div class='dept_zone'>
    <div class=' span-6'>
      Greeting text with instructions
    </div>
  </div>
</div>
</script>
<script type='text/plain' id='wet_autocomplete_t'><datalist>
<!--[if lte IE 9]><select><![endif]-->
  {{#orgs}}<option label="" value="{{.}}"></option>{{/orgs}}
 <!--[if lte IE 9]></select><![endif]-->
</datalist>
</script>
<script type='text/plain' id='main_t'>
  <h1>
    Financial data for {{lang org.dept}}
  </h1>

<div class='module-menu-section span-3 border-all'>
  <h4 class=''>{{gt "other_in_min"}}</h4>
  <ul class="list-bullet-none" style='margin-top:0px!important' id='other_depts_list'>
  </ul>
</div>
<div class='span-5 module-note module-simplify font-size-large margin-top-none margin-bottom-none ' 
  style='padding-bottom: 0px;outline: 1px solid #ccc'>
  <h3 class='margin-bottom-none'><span class="color-dark">
    Supplementary information about {{lang org.dept}} drawn from the 
    <a href='{{{gt "IGOC_site"}}}'  target='_new'>
      {{gt "org_info"}}
    </a>
  </h3>
  <table class='well-table table-medium margin-top-none margin-bottom-none'>
    <tbody>
      <tr>
        <th id='__legal_name'> {{gt "legal_name"}} </th>
        <td headers='__legal_name'> {{lang org.legal_name }}  </td>
      </tr>
      <tr>
        <th id='__dept_type'> {{gt "type"}} </th>
        <td headers='__dept_type'> {{lang org.org_type }}  </td>
      </tr>
      <tr>
        <th id='__website'> {{gt "website"}} </th>
        <td headers='__website'> <a href="http://{{{lang org.website}}}" class='dept_name' target='_blank'>{{lang org.dept}}</a>  </td>
      </tr>
      <tr>
        <th id='__minister'> {{gt "minister" }} </th>
        <td headers='__minister'> {{lang org.minister}}  </td>
      </tr>
      <tr>
        <th id='__mandate'> {{gt "mandate"}} </th>
        <td headers='__mandate'> {{{lang org.mandate}}}  </td>
      </tr>
      <tr>
        <th id='__legislation'> {{gt "legislation"}} </th>
        <td headers='__legislation'>
          {{#org.legislation}}
          <a href='http://google.com/search?q={{encodeURI .}}' target="_blank">
            {{{lang .}}}
          </a>
          {{/org.legislation}}
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class='clear'></div>
<div class='panels'>

</div>
<div class='table_content'>

</div>
</script>
<script type='text/plain' id='panels_t'>
  <!--
  <h2 class='font-xlarge'> {{gt 'current_year_fisc'}} </h2>
  <div class="row widget-row" >
      <div class='span-1'></div>
      <div class="span-2 border-all well" id='table1'>
      </div>                      
      <div class="span-2 border-all well" id='table2'>
      </div>                      
      <div class="span-2 border-all well" id='table3'>
      </div>                       
  </div>                           
  <div class="clear"></div>
  -->
  <h2 class='font-xlarge'> {{gt 'previous_year_fisc'}} </h2>
  <div class='row widget-row'>
      <div class='span-1'></div>
      <div class="span-2 border-all well" id='table4'>
      </div>                       
      <div class="span-2 border-all well" id='table5'>
      </div>                       
      <div class="span-2 border-all well" id='table6'>
      </div>                       
  </div>                           
</script>
<script type='text/plain' id='mini_t'>
  <div class='mini_t '>
    <div class='section-header'>
      <strong><span class='title '></span></strong>
    </div>
    <div>
      <span class='description '></span>
    </div>
    <div class='mini_payload margin-bottom-large font-small' >

    </div>
    <div class='clear'></div>
    <div class='details_button section-footer'>
      <a class='button button-none details float-right' href='#'> {{gt 'details'}} </a>
    </div>
  </div>
</script>
<script type='text/plain' id='nav_li'>
  <li><a href='#' class='ui-link'>{{text}}</a></li>
</script>
<script type='text/plain' id='dataview_t'>
<div class='tables'>
  <ul class='button-group'>
    <li >
    <a href='#' class='back button button-dark'>{{{gt "back"}}}</a>
    </li>
    <li>
      <a href='#' class='details button '
        title='{{gt "details_help"}}' 
        data-placement='top'>
        {{gt "details" }}
      </a>
    </li>

    <li>
    <a href='#' class='button '>
      {{gt "open_data_link"}}
      </a>
    </li>
  </ul>
  <h2> Description </h2>
  <div class='table_description'>

  </div>
  <h2> Data </h2>
  <div class='table_payload sidescroll' style='font-size: 12px'>

  </div>
  <h2> Graphs </h2>
  <div class='graph_payload'>

  </div>
</div>
</script>
<script type='text/plain' id='footnotes_t'> 
<div class='footnotes well well-small'>
  <table class="table-condensed">
    <tbody>
    {{#each fns}}
      <tr>
        <td> {{this.symbol}} </td>
        <td>{{lang this.note }} </td>
      </tr>
    {{/each}}
    </tbody>
  </table>
</div>
</script>
<script type='text/plain' id='org_list_t'>
<div class='org_list'>
  <div class='span-1'></div>
{{#each cols}}<div class='span-3'>
  <ul class='list-bullet-none'>
      {{#each this}}                    {{! this = array of ministries }}
    <li>{{lang this.0.min}} 
      <ul class='list-bullet-none'>
        {{#each this }}                 {{! this = ministry }}
          {{#is_dept this}}             {{! this = dept }}
          <li><strong><a class='org_select' href='#'>{{dept}}</a></strong></li>
        {{else}}
          <li><a class='org_select' href='#'>{{dept}}</a></li>
        {{/is_dept}}
      {{/each}}
      </ul>
  {{/each}}
  </ul>
  </div>
{{/each}}
</div>
</script>
<script type='text/plain' id='list_t'>
  <table class='{{extra_table_classes}} table well-table table-condensed '>
    {{#title}} <caption>{{.}}</caption> {{/title}}
    <thead></thead>
    <tbody></tbody>
    <tfoot></tfoot>
  </table>
</script>
<script type='text/plain' id='graph_grid_t'>
  <p>{{description}}</p>
    <div class='span-2 well sidebar border-all'  id='{{id}}_sidebar'
          style='height:500px;overflow-y:auto'>
    <p class='margin-bottom-none margin-top-none nav-header'>{{header}}</p>
    <ul class='list-bullet-none margin-bottom-none margin-top-none margin-left-small hover'>
      {{#items}}
      <li><a href='#{{id}}'>{{.}}</a></li>
      {{/items}}
    </ul>
  </div>
  <div class='span-6 border-all'>
    <div class='well graph'>
      <div style='height:500px' id="{{id}}" ></div>
    </div>
  </div>
</script>
<script type='text/plain' id='analytics_t'>
<div>
    <div class='table_div'>

    </div>
</div>
</script>
<script type='text/plain' id='stat_tr'>
  <tr class='{{#active_dept}}info{{/active_dept}}'>
    <td>
      {{ index }}
    </td>
    <td>
      <a href='#'>{{dept_name}} </a> 
    </td>
    <td>
      {{ col }}
    </td>
    </tr>
</script>
<script type='text/plain' id='header_t'>
  <th colspan='{{colspan}}'><div class='{{class_}}'> {{header}} </div></th>
</script>
</%block>
<%block name='extrajs'>
$(function(){

    var APP = ns('APP');

    APP.dispatcher.on("app_ready", function(app){

        Handlebars.registerHelper("gt",function(context){
          return app.get_text(context);
        });
        Handlebars.registerHelper("uri",function(context){
          return encodeURI(context[app.state.get("lang")]);
        });
        Handlebars.registerHelper("lang",function(context){
          try {
            context[app.state.get("lang")];
          }
          catch (err){debugger}
          return context[app.state.get("lang")];
        });
        Handlebars.registerHelper("encodeURI",function(context,options){
          if (_.has(context,'en') && _.has(context,"fr")){
            context = context[app.state.get("lang")];
          }
          return encodeURI(context);
        });
        Handlebars.registerHelper("is_dept",function(context,options){
          var dept = context['dept'][app.state.get("lang")];
          if (_.has(context,'org_type') && context['org_type']['en'] === 'Departments') {
            return options.fn({dept:dept});
          }else{
            return options.inverse({dept:dept});
          }
        });

        app.state.set("lang","en");
        app.state.set("use_footer",false);
        app.state.set("min_tot",true);
        app.state.set("goc_tot",true);

    });

    _.each(depts,function(org){
      org['mapped_data'] = {};
      org['mapped_objs'] = {};
    });

    APP.app = new APP.appView();
});
</%block>


